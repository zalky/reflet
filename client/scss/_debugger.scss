
$node-color: color.adjust($blue, $alpha: -0.2);
$node-border: 4px solid $node-color;
$node-radius: 8px;
$node-group-border: 2px;

$node-panel-border: 1px solid color.adjust($blue, $alpha: -0.91);
$node-panel-drop-shadow-color: color.adjust($blue, $alpha: -0.65);

$syntax-keyword-namespace: #9167db;
$syntax-keyword-name: #cb49f1;
$syntax-ref: $blue;

@mixin node {
    height: 2 * $node-radius;
    width:  2 * $node-radius;
    border-radius: $node-radius;
    background: $node-color;
}

@mixin node-group {
    @include node;
    position: absolute;
    border-top: none;
    border-left: none;
    border-right: none;
    border-bottom: $node-group-border solid $node-color;
    background: transparent;
}

.debug-tap {
    display: none;
}

.debug-node {
    @include node;
    position: fixed;
    transform: translate($node-radius, $node-radius);

    &:not(.group) > * {
        display: none;
    }

    > :nth-child(1) {
        @include node-group;
        transform: translateY(2 * $node-group-border);
    }

    > :nth-child(2) {
        @include node-group;
        transform: translateY(4 * $node-group-border);
    }
}

.debug-panel {
    position: fixed;
    height: 200px;
    width: 250px;
    border: $node-panel-border;
    border-radius: $node-radius;
    box-shadow: 0 0 80px rgba(0, 0, 0, 0.07);
    background: $body-color;
    transform-style: preserve-3d;

    $shadow-offset: 4px;

    > :last-child {
        position: absolute;
        height: 100%;
        width: 100%;
        top: $shadow-offset;
        left: $shadow-offset;
        border-radius: $node-radius + $shadow-offset / 2;
        background: $node-panel-drop-shadow-color;
        transform: translateZ(-4px);
    }
}

.debug-content {
    display: flex;
    flex-direction: column;

    > * {
        padding: 1rem;
    }

    > :not(:first-child) {
        border-top: $node-panel-border;
    }
}

.debug-map {
    display: grid;
    grid-template-columns: 14px auto 14px;
    margin: 0 -0.35rem;

    > .debug-map-data {
        padding: 0 0.25rem;
    }

    > :nth-child(3) {
        transform: scaleX(-100%);
    }
}

.debug-map-brace {
    display: flex;
    flex-direction: column;
    color: $blue;

    > :nth-child(2), > :nth-child(4) {
        flex: 1;
        width: 6.5px;
        border-right: 1px solid $blue;
    }
}

.debug-map-data {
    display: grid;
    position: relative;
    grid-template-columns: 1fr auto;
    font-family: $font-family-monospace;
    font-size: $font-size-xs;

    > div {
        display: contents;
        overflow: hidden;
    }
}

.debug-ref {
    color: $syntax-ref;
}

.debug-keyword {
    > :first-child {
        color: $syntax-keyword-namespace;
    }

    > :last-child {
        color: $syntax-keyword-name;
    }
}
